## 什么是进程和线程？

<b>一个进程就是一个程序的运行实例。</b>详细解释就是，启动一个程序的时候，操作系统会为该程序创建一块内存，用来存放代码、运行中的数据和一个执行任务的主线程，我们把这样的一个运行环境叫进程。

而线程是不能单独存在的，它是由进程来启动和管理的。线程是依附于进程的，如果一个进程中，使用多线程可以提升执行效率


## 单线程与多线程

* 单线程：即同一个时刻只能有一个线程在执行js代码
* 多线程：即同一个时刻可以同时有多个线程，然后每个线程执行一段代码，相当于同一时刻可以同时执行多段代码

```
let a = 1 + 1;
let b = 2 + 2;
let c = 3 + 3;
```
例如以下代码，如果采用单线程语言去执行的话，就需要分三步去执行，但是如果是多线程的话，就可以做到去创建三个线程，然后分别同时去执行一行语句，很显然，我们发现：<b>采用多线程可以同时并行处理多端代码，大大提升性能</b>

![image](http://note.youdao.com/yws/res/3709/1B03AF191B8746CCA6ABA2C91AFF9887)


那大家此时可能会有一个疑问，为什么js是一门单线程语言呢？

多线程虽然可以提升执行效率，但是也会带来新的问题，
试想一下，如果js 是多线程的，那么 如果同时有两个线程，一个线程要在div标签下插入dom，另外一个线程又要删除div标签，在这种情况下，使用多线程就会出现问题，浏览器以哪个为准呢，这就是js要设计成一门单线程语言的原因。


## 浏览器的发展历史

#### 单进程浏览器

![image](http://note.youdao.com/yws/res/3731/EF158D476CCF453AB806979AC149B2A0)

即我们的代码，页面渲染，页面展现，网络请求等都是在一个进程中。

问题1: 不稳定：早期浏览器是通过插件来实现，例如web视频，web游戏等较复杂的交互，但是插件本身易崩溃，但是插件又和和其他内容放在一个进程中运行，插件一崩溃，很有可能导致整个浏览器崩溃。

问题2: 不流畅：代码都运行中一个线程中（其实不仅是单进程，也是单线程），也就意味着同一时刻只能有一段代码在运行，那么如果遇到耗时的任务，很有可能导致整个代码运行被卡住，页面出现卡顿。

问题3: 不安全：通过早期的插件机制，很容易获取到我们页面的任意资源，因为他们都运行在一个线程里，如果恶意被引入有问题的插件或者脚本，我们页面的数据很容易被泄漏。


#### 多进程浏览器

正是由于单进程浏览器存在不安全，不稳定等一系列问题，才逐渐发展出了多进程浏览器，

![image](http://note.youdao.com/yws/res/3765/175E64AC5C8F4042A0A39C1A86B36E05)

* 浏览器主进程：负责页面展示，用户交互，以及子进程管理等
* 渲染进程：核心是将html/css/javascript转换成为用户可交互的网页，v8引擎就是运行在该进程中，默认情况下，浏览器会为每个tab页创建一个渲染进程。
* GPU进程：浏览器的ui界面都是通过GPU进程来绘制。
* 网络进程：即网络请求放在一个单独的进程来维护。
* 插件进程：负责插件的运行，因为插件容易崩溃，所以放在一个单独的进程中来运行，这样即使奔溃，也不影响页面其他内容。


#### 未来面向服务的架构

即浏览器整体架构会朝着现代操作系统所采用的“面向服务架构”的方向去发展，即把原来的模块都拆分成独立的底层服务，每个服务可以运行在独立的进程中，接口之间通过服务定义的接口去相互访问，从而构建一个更内聚，更耦合，更易于维护的系统。

